<%- include ./partials/header %>
<script>
	function getmonth(data) {
		switch (data) {
			case 0:
				return 'Jan';
				break;
			case 1:
				return 'Feb';
				break;
			case 2:
				return 'March';
				break;
			case 3:
				return 'Apr';
				break;
			case 4:
				return 'May';
				break;
			case 5:
				return 'Jun';
				break;
			case 6:
				return 'Jul';
				break;
			case 7:
				return 'Aug';
				break;
			case 8:
				return 'Sep';
				break;
			case 9:
				return 'Oct';
				break;
			case 10:
				return 'Nov';
				break;
			case 11:
				return 'Dec';
				break;
			default:
				break;
		}
	}
</script>
<main id="content">
	<div class="content-widget">
		<div class="container">
			<div class="row">
				<div class="col-md-8 categoryDiv">
					<h4 class="spanborder">
						<span class="text-capitalize"><%= cat %></span>
					</h4>
					<% if(post == "") { %>
					<h4>No Post for now</h4>
					<% } %> <% if(post != "") { %> <% if(post[0] != undefined) { %>
					<article class="first mb-3">
						<figure>
							<a href="/post/<%= post[0].slug %>"
								><img data-src="<%= post[0].file %>" alt="<%= post[0].title %>" class="blur-up lazyload"
							/></a>
						</figure>
						<h1 class="entry-title mb-3">
							<a href="/post/<%= post[0].slug %>"
								><%= post[0].title.charAt(0).toUpperCase() + post[0].title.substring(1) %></a
							>
						</h1>
						<div class="entry-excerpt">
							<p class="entry-tit">
								<% if(post[0].short != undefined) { %> <%= post[0].short.charAt(0).toUpperCase() +
								post[0].short.substring(1) %> <% } %>
							</p>
						</div>
						<div class="entry-meta align-items-center">
							<a class="author-avatar" href="/author/<%= post[0].postedBy.username %>">
								<div class="u-relative u-inlineBlock u-flex0">
									<img
										class="avatar-image avatar-image--smaller blur-up lazyload"
										data-toggle="tooltip"
										data-placement="bottom"
										data-src="<%= post[0].postedBy.profilePicture %>"
										title="Go to the profile of <%= post[0].postedBy.firstName %> <%= post[0].postedBy.lastName %> "
									/>
									<div
										class="avatar-halo u-absolute u-textColorGreenNormal svgIcon"
										style="width: calc(100% + 10px); height: calc(100% + 10px); top:-5px; left:-5px"
									>
										<svg viewBox="0 0 70 70" xmlns="http://www.w3.org/2000/svg">
											<path
												d="M5.53538374,19.9430227 C11.180401,8.78497536 22.6271155,1.6 35.3571429,1.6 C48.0871702,1.6 59.5338847,8.78497536 65.178902,19.9430227 L66.2496695,19.401306 C60.4023065,7.84329843 48.5440457,0.4 35.3571429,0.4 C22.17024,0.4 10.3119792,7.84329843 4.46461626,19.401306 L5.53538374,19.9430227 Z"
											></path>
											<path
												d="M65.178902,49.9077131 C59.5338847,61.0657604 48.0871702,68.2507358 35.3571429,68.2507358 C22.6271155,68.2507358 11.180401,61.0657604 5.53538374,49.9077131 L4.46461626,50.4494298 C10.3119792,62.0074373 22.17024,69.4507358 35.3571429,69.4507358 C48.5440457,69.4507358 60.4023065,62.0074373 66.2496695,50.4494298 L65.178902,49.9077131 Z"
											></path>
										</svg>
									</div>
								</div>
							</a>
							<a href="/author/<%= post[0].postedBy.username %>" class="text-capitalize"
								><%= post[0].postedBy.firstName %> <%= post[0].postedBy.lastName %></a
							>
							in <a href="/category/<%=post[0].category.slug %>" class="text-capitalize"><%= cat %></a><br />
							<span>
								<script>
									document.write(getmonth(parseInt('<%= post[0].createdAt.getMonth() %>')));
								</script>
								<%= post[0].createdAt.getDate() %></span
							>
							<span class="middotDivider"></span>
							<span class="readingTime" title="<%= time(post[0].short) %>"
								><%= time(post[0].short) %></span
							>
							<span class="svgIcon svgIcon--star">
								<svg class="svgIcon-use" width="15" height="15">
									<path
										d="M7.438 2.324c.034-.099.09-.099.123 0l1.2 3.53a.29.29 0 0 0 .26.19h3.884c.11 0 .127.049.038.111L9.8 8.327a.271.271 0 0 0-.099.291l1.2 3.53c.034.1-.011.131-.098.069l-3.142-2.18a.303.303 0 0 0-.32 0l-3.145 2.182c-.087.06-.132.03-.099-.068l1.2-3.53a.271.271 0 0 0-.098-.292L2.056 6.146c-.087-.06-.071-.112.038-.112h3.884a.29.29 0 0 0 .26-.19l1.2-3.52z"
									></path>
								</svg>
							</span>
						</div>
					</article>
					<% } %> <% } %>
					<div class="divider"></div>
					<% for(let i = 1; i < post.length; i++) { %>
					<article class="row justify-content-between mb-5 mr-0">
						<div class="col-md-9 ">
							<div class="align-self-center">
								<% if(post[i].showPostOnSlider == true) { %>
								<div class="capsSubtle mb-2">Editors' Pick</div>
								<% } %>
								<h3 class="entry-title mb-3">
									<a href="/post/<%= post[i].slug %>"
										><%= post[i].title.charAt(0).toUpperCase() + post[i].title.substring(1) %></a
									>
								</h3>
								<div class="entry-excerpt">
									<p class="entry-tit">
										<% if(post[i].short != undefined) { %> <%= post[i].short.charAt(0).toUpperCase()
										+ post[i].short.substring(1) %> <% } %>
									</p>
								</div>
								<div class="entry-meta align-items-center">
									<a href="/author/<%= post[i].postedBy.username %>" class="text-capitalize"
										><%= post[i].postedBy.firstName %> <%= post[i].postedBy.lastName %></a
									>
									in
									<a href="/category/<%= post[i].category.slug %>" class="text-capitalize"
										><%= post[i].category.name %></a
									><br />
									<span>
										<script>
											document.write(getmonth(parseInt('<%= post[i].createdAt.getMonth() %>')));
										</script>
										<%= post[i].createdAt.getDate() %></span
									>
									<span class="middotDivider"></span>
									<span class="readingTime" title="<%= time(post[i].short) %>"
										><%= time(post[i].short) %></span
									>
									<span class="svgIcon svgIcon--star">
										<svg class="svgIcon-use" width="15" height="15">
											<path
												d="M7.438 2.324c.034-.099.09-.099.123 0l1.2 3.53a.29.29 0 0 0 .26.19h3.884c.11 0 .127.049.038.111L9.8 8.327a.271.271 0 0 0-.099.291l1.2 3.53c.034.1-.011.131-.098.069l-3.142-2.18a.303.303 0 0 0-.32 0l-3.145 2.182c-.087.06-.132.03-.099-.068l1.2-3.53a.271.271 0 0 0-.098-.292L2.056 6.146c-.087-.06-.071-.112.038-.112h3.884a.29.29 0 0 0 .26-.19l1.2-3.52z"
											></path>
										</svg>
									</span>
								</div>
							</div>
						</div>
						<div class="col-md-3 bgcover blur-up lazyload" data-bg="<%= post[i].file %>"></div>
					</article>
					<% } %> <% if (pages > 0) { %>
					<ul class="page-numbers heading">
						<% if (current == 1) { %>
						<li><a class="disabled page-numbers" href="javascript:void(0);">First</a></li>
						<% } else { %>
						<li><a class="page-numbers" href="?page=1">First</a></li>
						<% } %> <% var i = (Number(current) > 3 ? Number(current) - 3 : 1) %> <% if (i !== 1) { %>
						<li><a class="disabled page-numbers" href="javascript:void(0);">...</a></li>
						<% } %> <% for (; i <= (Number(current) + 2) && i <= pages; i++) { %> <% if (i == current) { %>
						<li><span aria-current="page" class="page-numbers current"><%= i %></span></li>
						<% } else { %>
						<li><a class="page-numbers" href="?page=<%= i %>"><%= i %></a></li>
						<% } %> <% if (i == Number(current) + 2 && i < pages) { %>
						<li><a class="disabled page-numbers" href="javascript:void(0);">...</a></li>
						<% } %> <% } %> <% if (current == pages) { %>
						<li><a class="disabled page-numbers" href="javascript:void(0);">Last</a></li>
						<% } else { %>
						<li><a class="page-numbers" href="?page=<%= pages %>">Last</a></li>
						<% } %>
					</ul>
					<% } %>
				</div>
				<!--col-md-8-->
				<div class="col-md-4 pl-md-5 sticky-sidebar">
					<div class="sidebar-widget latest-tpl-4">
						<h5 class="spanborder widget-title">
							<span>Popular in <%= cat.charAt(0).toUpperCase() + cat.substring(1) %></span>
						</h5>
						<ol>
							<% for(let item of popular) { %>
							<li class="d-flex">
								<div class="post-count">0<%= popular.indexOf(item) +1 %></div>
								<div class="post-content">
									<h5 class="entry-title mb-3">
										<a href="/post/<%= item.slug %>"
											><%= item.title.charAt(0).toUpperCase() + item.title.substring(1) %></a
										>
									</h5>
									<div class="entry-meta align-items-center">
										<a href="/author/<%= item.postedBy.username %>" class="text-capitalize"
											><%= item.postedBy.firstName %> <%= item.postedBy.lastName %></a
										>
										in
										<a href="/category/<%= item.category.slug %>" class="text-capitalize"
											><%= item.category.name %></a
										><br />
										<span>
											<script>
												document.write(getmonth(parseInt('<%= item.createdAt.getMonth() %>')));
											</script>
											<%= item.createdAt.getDate() %></span
										>
										<span class="middotDivider"></span>
										<span class="readingTime" title="<%= time(item.short) %>"
											><%= time(item.short) %></span
										>
										<span class="svgIcon svgIcon--star">
											<svg class="svgIcon-use" width="15" height="15">
												<path
													d="M7.438 2.324c.034-.099.09-.099.123 0l1.2 3.53a.29.29 0 0 0 .26.19h3.884c.11 0 .127.049.038.111L9.8 8.327a.271.271 0 0 0-.099.291l1.2 3.53c.034.1-.011.131-.098.069l-3.142-2.18a.303.303 0 0 0-.32 0l-3.145 2.182c-.087.06-.132.03-.099-.068l1.2-3.53a.271.271 0 0 0-.098-.292L2.056 6.146c-.087-.06-.071-.112.038-.112h3.884a.29.29 0 0 0 .26-.19l1.2-3.52z"
												></path>
											</svg>
										</span>
									</div>
								</div>
							</li>
							<% } %>
						</ol>
					</div>
				</div>
				<!--col-md-4-->
			</div>
		</div>
		<!--content-widget-->
	</div>

	<div class="content-widget">
		<div class="container">
			<div class="sidebar-widget ads">
					<% if(categoryFooter[0] != undefined){ %>
						<a href="<%= categoryFooter[0].url %>"><img style="width: 600px !important; height: 70px !important; object-fit: cover !important;" alt="<%= siteTitle %>" data-src="<%= categoryFooter[0].fileName %>" class="blur-up lazyload img-fluid"></a>
					<% } %>
			</div>
			<div class="hr"></div>
		</div>
	</div>
	<!--content-widget-->
</main>

<%- include ./partials/footer %>
<script>
	let data = `<div class="container"><h5 class="spanborder widget-title">
                                        <span>Maybe you are interested
</span>
                                    </h5>
    <div class="row justify-content-between">
                                    <div class="divider-2"></div>
                                    <% for(let item of recent) { %>
                                        <article class="col-md-6">
                                        <div class="mb-3 d-flex row">
                                            <figure class="col-md-5"><a href="/post/<%= item.slug %>"><img data-src="<%= item.file %>" alt="<%= item.title %>" class="img-fluid blur-up lazyload" style="height: 128px; width: 100%; object-fit: cover;"></a></figure>
                                            <div class="entry-content col-md-7 pl-md-0">                                    
                                                <h5 class="entry-title mb-3"><a href="/post/<%= item.slug %>"><%= item.title.charAt(0).toUpperCase() + item.title.substring(1) %></a></h5>
                                                <div class="entry-meta align-items-center">
                                                    <a href="/author/<%= item.postedBy.username %>" class="text-capitalize"><%= item.postedBy.firstName %> <%= item.postedBy.lastName %></a> in <a href="/category/<%= item.category.slug %>" class="text-capitalize"><%= item.category.name %></a><br>                                    
                                                    <span> <%= getmonth(item.createdAt.getMonth()) %> <%= item.createdAt.getDate() %> </span>
                                                    <span class="middotDivider"></span>
                                                    <span class="readingTime" title="<%= time(item.short) %>"><%= time(item.short) %></span>
                                                    <span class="svgIcon svgIcon--star">
                                                        <svg class="svgIcon-use" width="15" height="15">
                                                            <path d="M7.438 2.324c.034-.099.09-.099.123 0l1.2 3.53a.29.29 0 0 0 .26.19h3.884c.11 0 .127.049.038.111L9.8 8.327a.271.271 0 0 0-.099.291l1.2 3.53c.034.1-.011.131-.098.069l-3.142-2.18a.303.303 0 0 0-.32 0l-3.145 2.182c-.087.06-.132.03-.099-.068l1.2-3.53a.271.271 0 0 0-.098-.292L2.056 6.146c-.087-.06-.071-.112.038-.112h3.884a.29.29 0 0 0 .26-.19l1.2-3.52z"></path>
                                                        </svg>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </article>
                                    <% } %>
                                </div></div>`;
	$('.categoryDiv article')
		.last()
		.prev()
		.prepend(data);
</script>
