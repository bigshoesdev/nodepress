<%- include ./partials/header %>
<style>
    @import 'https://fonts.googleapis.com/css?family=Nunito:300,400,600,700,800&subset=latin-ext';

    .profile-image {
        width: 50px !important;
        height: 50px !important;
        border-radius: 50px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, .15) !important;
        border: 2px solid transparent !important;
        object-fit: cover;
    }

    .small-box {
        border-radius: 2px;
        position: relative;
        display: block;
        margin-bottom: 20px;
        box-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);
    }

    .small-box .inner {
        position: relative;
        color: #fff !important;
        padding: 20px;
    }

    .small-box h3 {
        font-size: 38px;
        font-weight: bold;
        margin: 0 0 10px 0;
        white-space: nowrap;
        padding: 0;
        z-index: 4;
        color: #fff;
    }

    .small-box .inner a {
        color: #fff !important;
    }

    .small-box p {
        z-index: 5;
        font-size: 15px;
    }

    .bg-purple {
        background-color: #605ca8 !important;
    }

    .bg-success {
        background-color: #19a185 !important;
    }

    .bg-danger {
        background-color: #DE524A !important;
    }

    .bg-warning {
        background-color: #f1b740 !important;
    }

    .bg-gradient-primary {
        color: #fff !important;
        background: linear-gradient(87deg, #5e72e4 0, #825ee4 100%) !important;
    }

    .small-box .icon {
        top: 0;
        right: 20px;
        z-index: 0;
        font-size: 60px;
        color: rgba(0, 0, 0, 0.10);
        transition: all .3s linear;
        position: absolute;
    }

    .small-box .icon a {
        color: rgba(0, 0, 0, 0.10) !important;
    }

    .small-box:hover .icon a {
        transform: scale(1.4);
    }

    .chartJ {
        border-bottom: solid 2px #17a2b8 !important;
    }

    .headline {
        border-bottom: 1px solid #e4e4e4;
        display: block;
        padding: 20px 30px;
        border-bottom: 1px solid #e4e4e4;
        position: relative;
    }

    .chart {
        padding: 30px 20px 17px 18px;
    }
</style>
<%- include ./partials/sidebar %>

<!-- Content Body Start -->
<div class="content-body">

    <!-- Page Headings Start -->
    <div class="row justify-content-between align-items-center mb-10">

        <!-- Page Heading Start -->
        <div class="col-12 col-lg-auto mb-20">
            <div class="page-heading">
                <h3>Dashboard <span>/ <%= siteTitle %></span></h3>
            </div>
        </div><!-- Page Heading End -->

    </div><!-- Page Headings End -->

    <!-- Top Report Wrap Start -->
    <div class="row">
        <!-- Top Report Start -->
        <div class="col-lg-3 col-md-6  col-12 mb-30">

            <div class="small-box bg-success shadow-sm">
                <div class="inner">
                    <h3 class="increase-count" data-count="<%=totalPost%>"><%= totalPost %></h3>
                    <a href="/dashboard/all-posts">
                        <p><%= totalPost < 2 ? 'Post' : 'Posts' %></p>
                    </a>
                </div>
                <div class="icon">
                    <a href="/dashboard/all-posts">
                        <i class="fa fa-file"></i>
                    </a>
                </div>
            </div>
        </div>
        <!-- Top Report End -->

        <!-- Top Report Start -->
        <div class="col-lg-3 col-md-6  col-12 mb-30">
            <div class="small-box bg-danger shadow-sm">
                <div class="inner">
                    <h3 class="increase-count"><%= totalComments %></h3>
                    <a href="/dashboard/comments">
                        <p><%= totalComments < 2 ? 'Comment' : 'Comments' %></p>
                    </a>
                </div>
                <div class="icon">
                    <a href="/dashboard/comments">
                        <i class="ti-comment-alt"></i>
                    </a>
                </div>
            </div>
        </div><!-- Top Report End -->

        <!-- Top Report Start -->
        <div class="col-lg-3 col-md-6  col-12 mb-30">
            <div class="small-box bg-purple shadow-sm">
                <div class="inner">
                    <h3 class="increase-count"><%= pendingPost %></h3>
                    <a href="/dashboard/all-posts">
                        <p><%= pendingPost < 2 ? 'Inactive Post' : 'Inactive Posts' %></p>
                    </a>
                </div>
                <div class="icon">
                    <a href="/dashboard/all-posts">
                        <i class="fa fa-low-vision"></i>
                    </a>
                </div>
            </div>
        </div><!-- Top Report End -->

        <!-- Top Report Start -->
        <div class="col-lg-3 col-md-6  col-12 mb-30">
            <div class="small-box bg-warning shadow-sm">
                <div class="inner">
                    <h3 class="increase-count"><%= totalUsers %></h3>
                    <a href="/dashboard/users">
                        <p><%= totalUsers < 2 ? 'User' : 'Users' %></p>
                    </a>
                </div>
                <div class="icon">
                    <a href="/dashboard/users">
                        <i class="fa fa-users"></i>
                    </a>
                </div>
            </div>
        </div><!-- Top Report End -->

        <!-- Top Report Start -->
    </div><!-- Top Report Wrap End -->

    <!-- <div class="bg-white shadow-sm mt-3 mb-4 chartJ">
        <div class="">
            
        </div>
    </div> -->

    <!-- <div class="card shadow-sm mb-4">
        <div class="card-header" style="background-color: #f0f3f5;">Statistics</div>
        <div class="card-body">
            <div id="chart_div" style="width: 100% !important;">
            </div>
        </div>
    </div> -->

    <div class="row">
        <div class="col-md-6">
            <div class="bg-white shadow-sm p-3">
                <h4><b>Latest Comments</b></h4>
                <small>You can see latest comments here</small>
                <div class="table-responsive mt-3">
                    <table class="table">
                        <thead>
                            <th>Name</th>
                            <th>Comment</th>
                            <th>Date</th>
                        </thead>
                        <tbody>
                            <% for(let item of latestComment) { %>
                            <tr>
                                <td><%= item.name %></td>
                                <td><%= item.comment.substr(0,20) %></td>
                                <td><%= item.createdAt.toLocaleDateString() %> [<%= formatDate(item.createdAt) %>]</td>
                            </tr>
                            <% } %>
                        </tbody>
                    </table>
                </div>
                <div class="mt-3">
                    <a href="/dashboard/comments"><button class="btn btn-info btn-sm">View All</button></a>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="bg-white shadow-sm p-3">
                <h4><b>Latest Contact Messages</b></h4>
                <small>You can see latest contact messages here</small>
                <div class="table-responsive mt-3">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>FullName</th>
                                <th>Message</th>
                                <th>Date</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% for(var key in contact) { %>
                            <tr>
                                <td class="">
                                    <%= contact[key].fullname %>
                                </td>
                                <td>
                                    <span data-toggle="tooltip" data-placement="bottom" title="View">
                                        <a href="/dashboard/contacts/view/<%= contact[key]._id %>" target="_blank">
                                            <%= contact[key].message.substr(0, 15) %>..
                                        </a>
                                    </span>
                                </td>
                                <td>
                                    <%= contact[key].createdAt.toLocaleDateString() %>
                                    [<%= formatDate(contact[key].createdAt) %>]
                                </td>
                            </tr>
                            <% } %>
                        </tbody>
                    </table>
                </div>
                <div class="mt-3">
                    <a href="/dashboard/contacts"><button class="btn btn-info btn-sm">View All</button></a>
                </div>
            </div>
        </div>

        <div class="col-md-6 mt-4">
            <div class="bg-white shadow-sm p-3">
                <h4><b>Latest Users</b></h4>
                <small>You can see last registered users here</small>
                <div class="table-responsive mt-3">
                    <table class="table table-vertical-middle">
                        <thead>
                            <tr>
                                <th>Avatar</th>
                                <th>Username</th>
                                <th>Email</th>
                                <th>Date</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% for(var key in latestUsers) { %>
                            <tr>
                                <td>
                                    <img src="<%= latestUsers[key].profilePicture %>" class="img-fluid profile-image" style="width: 50px !important;
                                    height: 50px !important;" alt="">
                                </td>
                                <td class="text-capitalize" style="width: 160px;">
                                    <a href="/dashboard/users/edit/<%= latestUsers[key].username %>"
                                        data-toggle="tooltip" data-placement="bottom" title="Edit User">
                                        <%= latestUsers[key].username %>
                                    </a>
                                </td>
                                <td>
                                    <%= latestUsers[key].email %>
                                </td>
                                <td><%= formatDate(latestUsers[key].createdAt) %></td>
                            </tr>
                            <% } %>
                        </tbody>
                    </table>
                </div>
                <div class="mt-3">
                    <a href="/dashboard/users"><button class="btn btn-info btn-sm">View All</button></a>
                </div>
            </div>
        </div>

        <div class="col-md-6 mt-4">
            <div class="bg-white shadow-sm p-3">
                <h4><b>Latest Subscribers</b></h4>
                <small>You can see last subscribers here</small>
                <div class="table-responsive mt-3">
                    <table class="table table-vertical-middle">
                        <thead>
                            <tr>
                                <th>Email</th>
                                <th>Date</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% for(var key in latestSubscribers) { %>
                            <tr>
                                <td>
                                    <%= latestSubscribers[key].email %>
                                </td>
                                <td><%= formatDate(latestSubscribers[key].createdAt) %></td>
                            </tr>
                            <% } %>
                        </tbody>
                    </table>
                </div>
                <div class="mt-3">
                    <a href="/dashboard/newsletter"><button class="btn btn-info btn-sm">View All</button></a>
                </div>
            </div>
        </div>
    </div>

</div><!-- Content Body End -->

<!-- Footer Section Start -->
<div class="footer-section">
    <div class="container-fluid">

        <div class="footer-copyright text-center">
            <p class="text-body-light">
                <script>document.write(new Date().getFullYear())</script> &copy; <a
                    href="<%= siteLink %>"><%= siteTitle %></a></p>
        </div>

    </div>
</div><!-- Footer Section End -->

</div>

<!-- JS
============================================ -->

<!-- Global Vendor, plugins & Activation JS -->
<script src="/assets/js/vendor/modernizr-3.6.0.min.js"></script>
<script src="/assets/js/vendor/jquery-3.3.1.min.js"></script>
<script src="/assets/js/vendor/popper.min.js"></script>
<script src="/assets/js/vendor/bootstrap.min.js"></script>
<!--Plugins JS-->
<script src="/assets/js/plugins/perfect-scrollbar.min.js"></script>
<script src="/assets/js/plugins/tippy4.min.js.js"></script>
<!--Main JS-->
<script src="/assets/js/main.js"></script>

<!-- Plugins & Activation JS For Only This Page -->

<!--Moment-->
<script src="/assets/js/plugins/moment/moment.min.js"></script>

<!--Daterange Picker-->
<script src="/assets/js/plugins/daterangepicker/daterangepicker.js"></script>
<script src="/assets/js/plugins/daterangepicker/daterangepicker.active.js"></script>

<!--Echarts-->
<!-- <script src="/assets/js/plugins/chartjs/Chart.min.js"></script>
<script src="/assets/js/plugins/chartjs/chartjs.active.js"></script> -->

<script src="/assets/js/plugins/nice-select/jquery.nice-select.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/morrisjs/morris.js@0.5.1/morris.css">
<script src="https://cdn.jsdelivr.net/gh/DmitryBaranovskiy/raphael@v2.1.0/raphael-min.js" type="text/javascript"></script>
<script src="https://cdn.jsdelivr.net/gh/morrisjs/morris.js@0.5.1/morris.min.js" type="text/javascript"></script>

<script>
    $('select').niceSelect();
    $('.increase-count').each(function () {
        $(this).prop('Counter', 0).animate({
            Counter: $(this).text()
        }, {
                duration: 1000,
                easing: 'swing',
                step: function (now) {
                    $(this).text(Math.ceil(now));
                }
            });
    });

    // new Morris.Line({
    //             element: 'chart_div',
    //             resize: true,
    //             data: [
    //                 {date: "2019-09-01", views: 18},{date: "2019-09-02", views: 12},{date: "2019-09-03", views: 24},{date: "2019-09-04", views: 18},{date: "2019-09-05", views: 23},{date: "2019-09-06", views: 16},{date: "2019-09-07", views: 17},{date: "2019-09-08", views: 11},{date: "2019-09-09", views: 16},{date: "2019-09-10", views: 10},{date: "2019-09-11", views: 17},{date: "2019-09-12", views: 21},{date: "2019-09-13", views: 21},{date: "2019-09-14", views: 20},{date: "2019-09-15", views: 16},{date: "2019-09-16", views: 16},{date: "2019-09-17", views: 16},{date: "2019-09-18", views: 19},{date: "2019-09-19", views: 16},{date: "2019-09-20", views: 164},{date: "2019-09-21", views: 65},{date: "2019-09-22", views: 43},{date: "2019-09-23", views: 62},{date: "2019-09-24", views: 49},{date: "2019-09-25", views: 23},{date: "2019-09-26", views: 32},{date: "2019-09-27", views: 36},{date: "2019-09-28", views: 25},{date: "2019-09-29", views: 23},{date: "2019-09-30", views: 41},],
    //             xkey: 'date',
    //             xLabels: 'day',
    //             ykeys: ['views'],
    //             labels: ['Views'],
    //             lineColors: ['#3c8dbc'],
    //             lineWidth: 2,
    //             hideHover: 'auto',
    //             smooth: false,
    //         });

    // Chart.defaults.global.defaultFontFamily = "Nunito";
    // Chart.defaults.global.defaultFontColor = '#888';
    // Chart.defaults.global.defaultFontSize = '14';

    // var ctx = document.getElementById('chart').getContext('2d');

    // var chart = new Chart(ctx, {
    //     type: 'line',

    //     // The data for our dataset
    //     data: {
    //         labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
    //         // Information about the dataset
    //         datasets: [{
    //             label: "Visitors",
    //             backgroundColor: 'rgba(42,65,232,0.08)',
    //             borderColor: '#2a41e8',
    //             borderWidth: "3",
    //             data: ['30', '30', '30', '30', '30', 30, 30, 30, 30, 30, 30, 30],
    //             pointRadius: 5,
    //             pointHoverRadius: 5,
    //             pointHitRadius: 10,
    //             pointBackgroundColor: "#fff",
    //             pointHoverBackgroundColor: "#fff",
    //             pointBorderWidth: "2",
    //         }]
    //     },

    //     // Configuration options
    //     options: {

    //         layout: {
    //             padding: 10,
    //         },

    //         legend: { display: false },
    //         title: { display: false },

    //         scales: {
    //             yAxes: [{
    //                 scaleLabel: {
    //                     display: false
    //                 },
    //                 gridLines: {
    //                     borderDash: [6, 10],
    //                     color: "#d8d8d8",
    //                     lineWidth: 1,
    //                 },
    //             }],
    //             xAxes: [{
    //                 scaleLabel: { display: false },
    //                 gridLines: { display: false },
    //             }],
    //         },

    //         tooltips: {
    //             backgroundColor: '#333',
    //             titleFontSize: 13,
    //             titleFontColor: '#fff',
    //             bodyFontColor: '#fff',
    //             bodyFontSize: 13,
    //             displayColors: false,
    //             xPadding: 10,
    //             yPadding: 10,
    //             intersect: false
    //         }
    //     },
    // })
</script>

</body>

</html>